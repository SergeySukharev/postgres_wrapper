{"name": "test_income_equal[query11]", "status": "failed", "statusDetails": {"message": "AssertionError: assert 135660 == 332214\n  -135660\n  +332214", "trace": "query = ('create or replace function public.lilo_auto_qa() returns table(cnt int8)\\nlanguage plpgsql\\nas $f$\\nbegin\\n\\tdrop ta...v\\nwhere hcode_id = '00339'\\nand calc_rule = 'ratio'\\n--and dt in ()\\nunion all\\nselect * from public.lilo_auto_qa();\")\nconnection = <cursor object at 0x03AA31A8; closed: 0>\n\n    @allure.feature('Расчетные показатели')\n    @allure.story('Сравнение всех записей')\n    @allure.severity('critical')\n    @pytest.mark.parametrize('query', QUERIES_COMPARE)\n    def test_income_equal(query, connection):\n        if len(query) == 2:\n            connection.execute(query[0])\n            connection.execute(query[1])\n            lines = connection.fetchall()\n            connection.execute('drop function public.lilo_auto_qa();')\n    \n>           assert lines[0][0] == lines[1][0]\nE           assert 135660 == 332214\nE             -135660\nE             +332214\n\ntest_income.py:304: AssertionError"}, "parameters": [{"name": "query", "value": "(\"create or replace function public.lilo_auto_qa() returns table(cnt int8)\\nlanguage plpgsql\\nas $f$\\nbegin\\n\\tdrop table if exists public.la_qa1;\\n\\tdrop table if exists public.la_qa2;\\n\\tcreate table public.la_qa1 as\\n\\t\\tselect * from dm_rep.dm_all_indicators_v where hcode_id in ('00112') and calc_rule not in ('influence', 'deviation');\\n\\tcreate table public.la_qa2 as \\n\\t\\tselect * from dm_rep.dm_all_indicators_v where hcode_id in ('00021') and calc_rule not in ('influence', 'deviation');\\n\\treturn query\\nselect count(0) from public.la_qa1 a\\n\\tleft join public.la_qa2 b\\n\\t\\ton  a.org_id = b.org_id\\n\\t\\tand a.date_type_id = b.date_type_id\\n\\t\\tand a.cargo_type_id = b.cargo_type_id\\n\\t\\tand a.val_type_id = b.val_type_id\\n\\t\\tand a.dt = b.dt\\n\\t\\tand a.nod_id = b.nod_id\\n\\t\\tand a.duch_id = b.duch_id\\n\\t\\tand a.vids_id = b.vids_id \\n\\t\\tand a.kato_id = b.kato_id \\n\\t\\tand a.dir_id = b.dir_id\\n\\t;\\nend;\\n$f$\\n;\", \"select count(0) from dm_rep.dm_all_indicators_v\\nwhere hcode_id = '00339'\\nand calc_rule = 'ratio'\\n--and dt in ()\\nunion all\\nselect * from public.lilo_auto_qa();\")"}], "start": 1604830816797, "stop": 1604830844612, "uuid": "2ebc0a4e-9fa7-4cd3-8302-f61322dc64eb", "historyId": "34947beafb1ab73de072538203c3298f", "testCaseId": "b1f59914a2914a84f38d1c0adcd0ac2e", "fullName": "test_income#test_income_equal", "labels": [{"name": "feature", "value": "Расчетные показатели"}, {"name": "severity", "value": "critical"}, {"name": "story", "value": "Сравнение всех записей"}, {"name": "suite", "value": "test_income"}, {"name": "host", "value": "62032-nb"}, {"name": "thread", "value": "13564-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_income"}]}