{"name": "test_income_equal[query12]", "status": "passed", "parameters": [{"name": "query", "value": "(\"create or replace function public.lilo_auto_qa() returns table(cnt int8)\\nlanguage plpgsql\\nas $f$\\nbegin\\n\\tdrop table if exists public.la_qa1;\\n\\tdrop table if exists public.la_qa2;\\n\\tdrop table if exists public.la_qa3;\\n\\tdrop table if exists public.la_qa4;\\n\\tdrop table if exists public.la_qa5;\\n\\tcreate table public.la_qa1 as\\n\\t\\tselect * from dm_rep.dm_all_indicators_v where hcode_id in ('00109') and metric_type_id = 1;\\n\\tcreate table public.la_qa2 as \\n\\t\\tselect * from dm_rep.dm_all_indicators_v where hcode_id in ('00168') and metric_type_id = 1;\\n\\tcreate table public.la_qa3 as\\n\\t\\tselect * from dm_rep.dm_all_indicators_v where hcode_id in ('00169') and metric_type_id = 1;\\n\\tcreate table public.la_qa4 as\\n\\t\\tselect * from dm_rep.dm_all_indicators_v where hcode_id in ('00170') and metric_type_id = 1; \\n\\tcreate table public.la_qa5 as\\n\\t\\tselect * from dm_rep.dm_all_indicators_v where hcode_id in ('00154') and metric_type_id = 17; \\n\\treturn query\\nselect count(0) from (\\nselect  \\ncoalesce (abc.org_id, d.org_id) as org_id,  \\ncoalesce (abc.date_type_id, d.date_type_id) as date_type_id, \\ncoalesce (abc.metric_type_id, d.metric_type_id) as metric_type_id, \\ncoalesce (abc.cargo_type_id, d.cargo_type_id) as cargo_type_id, \\ncoalesce (abc.val_type_id, d.val_type_id) as val_type_id, \\ncoalesce (abc.dt, d.dt) as dt, \\ncoalesce (abc.duch_id, d.duch_id) as duch_id, \\ncoalesce (abc.nod_id, d.nod_id) as nod_id, \\ncoalesce (abc.dir_id, d.dir_id) as dir_id, \\ncoalesce (abc.kato_id, d.kato_id) as kato_id, \\ncoalesce (abc.vids_id, d.vids_id) as vids_id\\nfrom(\\nselect  \\ncoalesce (ab.org_id, c.org_id) as org_id,  \\ncoalesce (ab.date_type_id, c.date_type_id) as date_type_id, \\ncoalesce (ab.metric_type_id, c.metric_type_id) as metric_type_id, \\ncoalesce (ab.cargo_type_id, c.cargo_type_id) as cargo_type_id, \\ncoalesce (ab.val_type_id, c.val_type_id) as val_type_id, \\ncoalesce (ab.dt, c.dt) as dt, \\ncoalesce (ab.duch_id, c.duch_id) as duch_id, \\ncoalesce (ab.nod_id, c.nod_id) as nod_id, \\ncoalesce (ab.dir_id, c.dir_id) as dir_id, \\ncoalesce (ab.kato_id, c.kato_id) as kato_id, \\ncoalesce (ab.vids_id, c.vids_id) as vids_id\\nfrom(\\nselect\\ncoalesce (a.org_id, b.org_id) as org_id,  \\ncoalesce (a.date_type_id, b.date_type_id) as date_type_id, \\ncoalesce (a.metric_type_id, b.metric_type_id) as metric_type_id, \\ncoalesce (a.cargo_type_id, b.cargo_type_id) as cargo_type_id, \\ncoalesce (a.val_type_id, b.val_type_id) as val_type_id, \\ncoalesce (a.dt, b.dt) as dt, \\ncoalesce (a.duch_id, b.duch_id) as duch_id, \\ncoalesce (a.nod_id, b.nod_id) as nod_id, \\ncoalesce (a.dir_id, b.dir_id) as dir_id, \\ncoalesce (a.kato_id, b.kato_id) as kato_id, \\ncoalesce (a.vids_id, b.vids_id) as vids_id\\nfrom public.la_qa1 a\\n    full join public.la_qa2 b\\n        on  a.org_id = b.org_id\\n        and a.date_type_id = b.date_type_id\\n        and a.cargo_type_id = b.cargo_type_id\\n        and a.val_type_id = b.val_type_id\\n        and a.dt = b.dt\\n        and a.nod_id = b.nod_id\\n        and a.duch_id = b.duch_id\\n        and a.vids_id = b.vids_id \\n        and a.kato_id = b.kato_id \\n        and a.dir_id = b.dir_id) ab\\n   full join public.la_qa3 c\\n        on  ab.org_id = c.org_id\\n        and ab.date_type_id = c.date_type_id\\n        and ab.cargo_type_id = c.cargo_type_id\\n        and ab.val_type_id = c.val_type_id\\n        and ab.dt = c.dt\\n      and ab.nod_id = c.nod_id\\n      and ab.duch_id = c.duch_id\\n      and ab.vids_id = c.vids_id \\n      and ab.kato_id = c.kato_id \\n      and ab.dir_id = c.dir_id)abc\\n\\tfull join public.la_qa4 d\\n     on abc.org_id = d.org_id\\n      and abc.date_type_id = d.date_type_id\\n      and abc.cargo_type_id = d.cargo_type_id\\n      and abc.val_type_id = d.val_type_id\\n      and abc.dt = d.dt\\n      and abc.nod_id = d.nod_id\\n      and abc.duch_id = d.duch_id\\n      and abc.vids_id = d.vids_id \\n      and abc.kato_id = d.kato_id \\n      and abc.dir_id = d.dir_id\\n     )abcd\\n join public.la_qa5 e\\n     on abcd.org_id = e.org_id\\n      and abcd.date_type_id = e.date_type_id\\n      and abcd.cargo_type_id = e.cargo_type_id\\n      and abcd.val_type_id = e.val_type_id\\n      and abcd.dt = e.dt\\n      and abcd.nod_id = e.nod_id\\n      and abcd.duch_id = e.duch_id\\n      and abcd.vids_id = e.vids_id \\n      and abcd.kato_id = e.kato_id \\n      and abcd.dir_id = e.dir_id\\n    ;\\nend;\\n$f$\\n;\", \"select count(0) from dm_rep.dm_all_indicators_v\\nwhere hcode_id = '00340'\\nand calc_rule = 'ratio'\\n--and dt in ()\\nunion all\\nselect * from public.lilo_auto_qa();\")"}], "start": 1604830844655, "stop": 1604830855092, "uuid": "39616e76-d962-4a69-8357-a6f49eed5e57", "historyId": "0ce690f5d9c32bd4e9d922e171f8e16d", "testCaseId": "b1f59914a2914a84f38d1c0adcd0ac2e", "fullName": "test_income#test_income_equal", "labels": [{"name": "feature", "value": "Расчетные показатели"}, {"name": "severity", "value": "critical"}, {"name": "story", "value": "Сравнение всех записей"}, {"name": "suite", "value": "test_income"}, {"name": "host", "value": "62032-nb"}, {"name": "thread", "value": "13564-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_income"}]}